import datetime

import mysql.connector

price = [{'tokenPrice': '1655741000000', 'timestamp': '1668668123'}, {'tokenPrice': '1655173500000', 'timestamp': '1668664535'}, {'tokenPrice': '1650407789149', 'timestamp': '1668660935'}, {'tokenPrice': '1644871000000', 'timestamp': '1668657959'}, {'tokenPrice': '1653801000000', 'timestamp': '1668657323'}, {'tokenPrice': '1661642241258', 'timestamp': '1668653723'}, {'tokenPrice': '1668565000000', 'timestamp': '1668650123'}, {'tokenPrice': '1668290000000', 'timestamp': '1668646547'}, {'tokenPrice': '1665587236693', 'timestamp': '1668642947'}, {'tokenPrice': '1667712087215', 'timestamp': '1668639731'}, {'tokenPrice': '1657923989817', 'timestamp': '1668639347'}, {'tokenPrice': '1652942322010', 'timestamp': '1668635735'}, {'tokenPrice': '1657201149379', 'timestamp': '1668632135'}, {'tokenPrice': '1653549052916', 'timestamp': '1668628595'}, {'tokenPrice': '1653923562910', 'timestamp': '1668624995'}, {'tokenPrice': '1656730000000', 'timestamp': '1668621407'}, {'tokenPrice': '1658419910429', 'timestamp': '1668620927'}, {'tokenPrice': '1650082017719', 'timestamp': '1668617747'}, {'tokenPrice': '1651210775594', 'timestamp': '1668617363'}, {'tokenPrice': '1642536965759', 'timestamp': '1668614135'}, {'tokenPrice': '1642024853888', 'timestamp': '1668613775'}, {'tokenPrice': '1650919455484', 'timestamp': '1668611591'}, {'tokenPrice': '1642170048946', 'timestamp': '1668610535'}, {'tokenPrice': '1644164347894', 'timestamp': '1668610451'}, {'tokenPrice': '1652730116759', 'timestamp': '1668609215'}, {'tokenPrice': '1644156000000', 'timestamp': '1668607835'}, {'tokenPrice': '1652915246248', 'timestamp': '1668606935'}, {'tokenPrice': '1654894870211', 'timestamp': '1668605915'}, {'tokenPrice': '1663801000000', 'timestamp': '1668605615'}, {'tokenPrice': '1654050100000', 'timestamp': '1668603971'}, {'tokenPrice': '1662989500000', 'timestamp': '1668603335'}, {'tokenPrice': '1660277000000', 'timestamp': '1668601787'}, {'tokenPrice': '1670027282854', 'timestamp': '1668599735'}, {'tokenPrice': '1670330562348', 'timestamp': '1668596135'}, {'tokenPrice': '1670942173235', 'timestamp': '1668592523'}, {'tokenPrice': '1676250000000', 'timestamp': '1668588923'}, {'tokenPrice': '1674749683386', 'timestamp': '1668587723'}, {'tokenPrice': '1683240000000', 'timestamp': '1668585623'}, {'tokenPrice': '1685267000000', 'timestamp': '1668585323'}, {'tokenPrice': '1685300377099', 'timestamp': '1668581723'}, {'tokenPrice': '1682209597185', 'timestamp': '1668579647'}, {'tokenPrice': '1690954840847', 'timestamp': '1668578147'}, {'tokenPrice': '1689724542079', 'timestamp': '1668574571'}, {'tokenPrice': '1694263000000', 'timestamp': '1668570947'}, {'tokenPrice': '1692427000000', 'timestamp': '1668567347'}, {'tokenPrice': '1691088000000', 'timestamp': '1668566003'}, {'tokenPrice': '1681194830916', 'timestamp': '1668563735'}, {'tokenPrice': '1679374371519', 'timestamp': '1668560135'}, {'tokenPrice': '1678542000000', 'timestamp': '1668559643'}, {'tokenPrice': '1686990000000', 'timestamp': '1668556535'}, {'tokenPrice': '1687061000000', 'timestamp': '1668552935'}, {'tokenPrice': '1689348000000', 'timestamp': '1668549335'}, {'tokenPrice': '1687692635036', 'timestamp': '1668549179'}, {'tokenPrice': '1679224000000', 'timestamp': '1668545735'}, {'tokenPrice': '1678123771448', 'timestamp': '1668544379'}, {'tokenPrice': '1686794562229', 'timestamp': '1668542495'}, {'tokenPrice': '1677193000000', 'timestamp': '1668542123'}, {'tokenPrice': '1678579100018', 'timestamp': '1668540119'}, {'tokenPrice': '1669952000000', 'timestamp': '1668538799'}, {'tokenPrice': '1670339314234', 'timestamp': '1668538583'}, {'tokenPrice': '1669267000000', 'timestamp': '1668537599'}, {'tokenPrice': '1680830939861', 'timestamp': '1668537179'}, {'tokenPrice': '1691688028601', 'timestamp': '1668536519'}, {'tokenPrice': '1700421794733', 'timestamp': '1668534923'}, {'tokenPrice': '1696038000000', 'timestamp': '1668531359'}, {'tokenPrice': '1698151500000', 'timestamp': '1668527747'}, {'tokenPrice': '1696056000000', 'timestamp': '1668527603'}, {'tokenPrice': '1704765748783', 'timestamp': '1668527003'}, {'tokenPrice': '1694490800000', 'timestamp': '1668526103'}, {'tokenPrice': '1685934271626', 'timestamp': '1668524147'}, {'tokenPrice': '1684227523610', 'timestamp': '1668523727'}, {'tokenPrice': '1693016000000', 'timestamp': '1668520727'}, {'tokenPrice': '1693246000000', 'timestamp': '1668520607'}, {'tokenPrice': '1693219000588', 'timestamp': '1668520067'}, {'tokenPrice': '1703032744477', 'timestamp': '1668519131'}, {'tokenPrice': '1694198927380', 'timestamp': '1668519071'}, {'tokenPrice': '1682160000000', 'timestamp': '1668516947'}, {'tokenPrice': '1677837056604', 'timestamp': '1668513347'}, {'tokenPrice': '1674015000000', 'timestamp': '1668511175'}, {'tokenPrice': '1682876000000', 'timestamp': '1668511031'}, {'tokenPrice': '1691978819999', 'timestamp': '1668510371'}, {'tokenPrice': '1683240468636', 'timestamp': '1668510131'}, {'tokenPrice': '1682924862764', 'timestamp': '1668509807'}, {'tokenPrice': '1676795000000', 'timestamp': '1668506135'}, {'tokenPrice': '1681603869577', 'timestamp': '1668504815'}, {'tokenPrice': '1690458294708', 'timestamp': '1668502607'}, {'tokenPrice': '1691740478194', 'timestamp': '1668500615'}, {'tokenPrice': '1683042211790', 'timestamp': '1668499235'}, {'tokenPrice': '1682193800000', 'timestamp': '1668498935'}, {'tokenPrice': '1678701000000', 'timestamp': '1668497519'}, {'tokenPrice': '1688459928032', 'timestamp': '1668496775'}, {'tokenPrice': '1679037871501', 'timestamp': '1668496415'}, {'tokenPrice': '1670132500154', 'timestamp': '1668495335'}, {'tokenPrice': '1665146000000', 'timestamp': '1668491735'}, {'tokenPrice': '1667103000000', 'timestamp': '1668491015'}, {'tokenPrice': '1675567000000', 'timestamp': '1668488135'}, {'tokenPrice': '1679429580661', 'timestamp': '1668484523'}, {'tokenPrice': '1683448000000', 'timestamp': '1668483287'}, {'tokenPrice': '1674809000000', 'timestamp': '1668480923'}, {'tokenPrice': '1672582000000', 'timestamp': '1668477323'}


,{'tokenPrice': '1674574000000', 'timestamp': '1668476987'}, {'tokenPrice': '1666124242134', 'timestamp': '1668476723'}, {'tokenPrice': '1657398617522', 'timestamp': '1668473783'}, {'tokenPrice': '1661210022138', 'timestamp': '1668470147'}, {'tokenPrice': '1666908716611', 'timestamp': '1668468911'}, {'tokenPrice': '1658340112228', 'timestamp': '1668467831'}, {'tokenPrice': '1649110535389', 'timestamp': '1668467267'}, {'tokenPrice': '1640483062696', 'timestamp': '1668466547'}, {'tokenPrice': '1637210000000', 'timestamp': '1668462947'}, {'tokenPrice': '1633568570290', 'timestamp': '1668461171'}, {'tokenPrice': '1624713500000', 'timestamp': '1668459335'}, {'tokenPrice': '1625498000000', 'timestamp': '1668455831'}, {'tokenPrice': '1636219000000', 'timestamp': '1668455747'}, {'tokenPrice': '1640993863695', 'timestamp': '1668455195'}, {'tokenPrice': '1651715521778', 'timestamp': '1668453491'}, {'tokenPrice': '1660799000000', 'timestamp': '1668452135'}, {'tokenPrice': '1655708000000', 'timestamp': '1668448535'}, {'tokenPrice': '1653738836591', 'timestamp': '1668447155'}, {'tokenPrice': '1645380471475', 'timestamp': '1668444935'}, {'tokenPrice': '1639221000000', 'timestamp': '1668442787'}, {'tokenPrice': '1647919000000', 'timestamp': '1668442475'}, {'tokenPrice': '1656255000000', 'timestamp': '1668441335'}, {'tokenPrice': '1656804695922', 'timestamp': '1668441299'}, {'tokenPrice': '1648389998149', 'timestamp': '1668439919'}, {'tokenPrice': '1656781000000', 'timestamp': '1668437747'}, {'tokenPrice': '1653427167559', 'timestamp': '1668436667'}, {'tokenPrice': '1662662000000', 'timestamp': '1668435803'}, {'tokenPrice': '1672324417107', 'timestamp': '1668434267'}, {'tokenPrice': '1662682000000', 'timestamp': '1668434183'}, {'tokenPrice': '1667210000000', 'timestamp': '1668433943'}, {'tokenPrice': '1681708000000', 'timestamp': '1668433883'}, {'tokenPrice': '1698777000000', 'timestamp': '1668433823'}, {'tokenPrice': '1712247000000', 'timestamp': '1668432623'}, {'tokenPrice': '1703018196338', 'timestamp': '1668432263'}, {'tokenPrice': '1692144401641', 'timestamp': '1668431687'}, {'tokenPrice': '1677847280613', 'timestamp': '1668430547'}, {'tokenPrice': '1673925000000', 'timestamp': '1668426947'}, {'tokenPrice': '1677281000000', 'timestamp': '1668423347'}, {'tokenPrice': '1675154000000', 'timestamp': '1668419807'}, {'tokenPrice': '1668057168954', 'timestamp': '1668416891'}, {'tokenPrice': '1677028458176', 'timestamp': '1668416135'}, {'tokenPrice': '1679735000000', 'timestamp': '1668412835'}, {'tokenPrice': '1678861537179', 'timestamp': '1668412535'}, {'tokenPrice': '1679130000000', 'timestamp': '1668411971'}, {'tokenPrice': '1670676696949', 'timestamp': '1668411047'}, {'tokenPrice': '1660074000000', 'timestamp': '1668410855'}, {'tokenPrice': '1648754353254', 'timestamp': '1668410771'}, {'tokenPrice': '1640403000000', 'timestamp': '1668410411'}, {'tokenPrice': '1649300000000', 'timestamp': '1668409631'}, {'tokenPrice': '1660124728925', 'timestamp': '1668409211'}, {'tokenPrice': '1643256000000', 'timestamp': '1668408947'}, {'tokenPrice': '1646660000000', 'timestamp': '1668408851'}, {'tokenPrice': '1637299512838', 'timestamp': '1668408407'}, {'tokenPrice': '1624053519644', 'timestamp': '1668408251'}, {'tokenPrice': '1615010000000', 'timestamp': '1668408191'}, {'tokenPrice': '1604810353525', 'timestamp': '1668408167'}, {'tokenPrice': '1594892821937', 'timestamp': '1668407855'}, {'tokenPrice': '1586770554167', 'timestamp': '1668405335'}, {'tokenPrice': '1583837000000', 'timestamp': '1668404819'}, {'tokenPrice': '1592425000000', 'timestamp': '1668401735'}, {'tokenPrice': '1596096000000', 'timestamp': '1668399647'}, {'tokenPrice': '1604465466644', 'timestamp': '1668399455'}, {'tokenPrice': '1612820316250', 'timestamp': '1668398135'}, {'tokenPrice': '1612752000000', 'timestamp': '1668394859'}, {'tokenPrice': '1603503808221', 'timestamp': '1668394523'}, {'tokenPrice': '1603866516664', 'timestamp': '1668393059'}, {'tokenPrice': '1595500000000', 'timestamp': '1668391979'}, {'tokenPrice': '1604931021707', 'timestamp': '1668390923'}, {'tokenPrice': '1607227000000', 'timestamp': '1668390095'}, {'tokenPrice': '1615490290969', 'timestamp': '1668389483'}, {'tokenPrice': '1624029300000', 'timestamp': '1668387323'}, {'tokenPrice': '1620288859175', 'timestamp': '1668385559'}, {'tokenPrice': '1631950492875', 'timestamp': '1668383723'}, {'tokenPrice': '1633727000000', 'timestamp': '1668381563'}, {'tokenPrice': '1642758683521', 'timestamp': '1668380207'}, {'tokenPrice': '1638919800000', 'timestamp': '1668376523'}, {'tokenPrice': '1643935971353', 'timestamp': '1668375623'}, {'tokenPrice': '1634501572498', 'timestamp': '1668373463'}, {'tokenPrice': '1646429213542', 'timestamp': '1668372959'}, {'tokenPrice': '1652346752761', 'timestamp': '1668369347'}, {'tokenPrice': '1648513000000', 'timestamp': '1668365735'}, {'tokenPrice': '1653333628518', 'timestamp': '1668362135'}, {'tokenPrice': '1647347664605', 'timestamp': '1668359795'}, {'tokenPrice': '1658108549410', 'timestamp': '1668358535'}, {'tokenPrice': '1654428845236', 'timestamp': '1668354935'}, {'tokenPrice': '1653116617517', 'timestamp': '1668353171'}, {'tokenPrice': '1661536114507', 'timestamp': '1668351335'}, {'tokenPrice': '1664471000000', 'timestamp': '1668347735'}, {'tokenPrice': '1659902280537', 'timestamp': '1668344135'}, {'tokenPrice': '1663924546555', 'timestamp': '1668340523'}, {'tokenPrice': '1665437000000', 'timestamp': '1668339359'}, {'tokenPrice': '1656119000000', 'timestamp': '1668336923'}, {'tokenPrice': '1651571405848', 'timestamp': '1668333323'}, {'tokenPrice': '1647293000000', 'timestamp': '1668330683'}, {'tokenPrice': '1655650125813', 'timestamp': '1668330443'}, {'tokenPrice': '1665946722082', 'timestamp': '1668329723'}, {'tokenPrice': '1674490954237', 'timestamp': '1668326507'}, {'tokenPrice': '1674366500000', 'timestamp': '1668326147'}, {'tokenPrice': '1670169000000', 'timestamp': '1668323351'}, {'tokenPrice': '1660850877559', 'timestamp': '1668322931'}




,{'tokenPrice': '1670102245958', 'timestamp': '1668322547'}, {'tokenPrice': '1670856000000', 'timestamp': '1668322091'}, {'tokenPrice': '1682860055029', 'timestamp': '1668318947'}, {'tokenPrice': '1684055000000', 'timestamp': '1668315359'}, {'tokenPrice': '1688451000000', 'timestamp': '1668311735'}, {'tokenPrice': '1685502986927', 'timestamp': '1668308135'}, {'tokenPrice': '1684337830236', 'timestamp': '1668304535'}, {'tokenPrice': '1682748000000', 'timestamp': '1668300935'}, {'tokenPrice': '1677667853764', 'timestamp': '1668297335'}, {'tokenPrice': '1680886460860', 'timestamp': '1668293735'}, {'tokenPrice': '1679566355469', 'timestamp': '1668290123'}, {'tokenPrice': '1679058000000', 'timestamp': '1668286523'}, {'tokenPrice': '1677393000000', 'timestamp': '1668286223'}, {'tokenPrice': '1686288000000', 'timestamp': '1668282923'}, {'tokenPrice': '1683837528857', 'timestamp': '1668279323'}, {'tokenPrice': '1686908649336', 'timestamp': '1668275747'}, {'tokenPrice': '1685829000000', 'timestamp': '1668272147'}, {'tokenPrice': '1690594568623', 'timestamp': '1668268523'}, {'tokenPrice': '1694702032485', 'timestamp': '1668266147'}, {'tokenPrice': '1686082610088', 'timestamp': '1668264947'}, {'tokenPrice': '1689795035356', 'timestamp': '1668264587'}, {'tokenPrice': '1681136397691', 'timestamp': '1668261347'}, {'tokenPrice': '1681628000000', 'timestamp': '1668257735'}, {'tokenPrice': '1682399200000', 'timestamp': '1668254135'}, {'tokenPrice': '1681582401455', 'timestamp': '1668250535'}, {'tokenPrice': '1682112000000', 'timestamp': '1668246935'}, {'tokenPrice': '1680053015393', 'timestamp': '1668243335'}, {'tokenPrice': '1677468000000', 'timestamp': '1668240035'}, {'tokenPrice': '1677007871962', 'timestamp': '1668239735'}, {'tokenPrice': '1674096000000', 'timestamp': '1668236123'}, {'tokenPrice': '1671283996445', 'timestamp': '1668233603'}, {'tokenPrice': '1662583104342', 'timestamp': '1668232523'}, {'tokenPrice': '1668573370032', 'timestamp': '1668230003'}, {'tokenPrice': '1677891000000', 'timestamp': '1668228923'}, {'tokenPrice': '1677531119734', 'timestamp': '1668227603'}, {'tokenPrice': '1686233000000', 'timestamp': '1668225323'}, {'tokenPrice': '1680486032246', 'timestamp': '1668223463'}, {'tokenPrice': '1689099300000', 'timestamp': '1668221747'}, {'tokenPrice': '1686632000000', 'timestamp': '1668218147'}, {'tokenPrice': '1687182500000', 'timestamp': '1668214559'}, {'tokenPrice': '1693932000000', 'timestamp': '1668212327'}, {'tokenPrice': '1702828000000', 'timestamp': '1668211007'}, {'tokenPrice': '1703432514177', 'timestamp': '1668210851'}, {'tokenPrice': '1690477461504', 'timestamp': '1668210011'}, {'tokenPrice': '1681249112556', 'timestamp': '1668208751'}, {'tokenPrice': '1690334000000', 'timestamp': '1668207335'}, {'tokenPrice': '1686375000000', 'timestamp': '1668205775'}, {'tokenPrice': '1677895000000', 'timestamp': '1668203735'}, {'tokenPrice': '1673678504275', 'timestamp': '1668201395'}, {'tokenPrice': '1664026426594', 'timestamp': '1668200135'}, {'tokenPrice': '1665904184943', 'timestamp': '1668198635'}, {'tokenPrice': '1674317000000', 'timestamp': '1668196547'}, {'tokenPrice': '1671140000000', 'timestamp': '1668196103'}, {'tokenPrice': '1679761860438', 'timestamp': '1668193895'}, {'tokenPrice': '1669949516924', 'timestamp': '1668193415'}, {'tokenPrice': '1680518500000', 'timestamp': '1668192935'}, {'tokenPrice': '1684461000000', 'timestamp': '1668192191'}, {'tokenPrice': '1694139815402', 'timestamp': '1668189839'}, {'tokenPrice': '1685201000000', 'timestamp': '1668189395'}, {'tokenPrice': '1676563184762', 'timestamp': '1668188123'}, {'tokenPrice': '1685768000000', 'timestamp': '1668186719'}, {'tokenPrice': '1676236908706', 'timestamp': '1668185723'}, {'tokenPrice': '1673847000000', 'timestamp': '1668185075'}, {'tokenPrice': '1665481000000', 'timestamp': '1668183491'}, {'tokenPrice': '1674694300000', 'timestamp': '1668183083'}, {'tokenPrice': '1684856501110', 'timestamp': '1668182123'}, {'tokenPrice': '1687415906671', 'timestamp': '1668181919'}, {'tokenPrice': '1677670502862', 'timestamp': '1668181103'}, {'tokenPrice': '1687424408321', 'timestamp': '1668179687'}, {'tokenPrice': '1676339000000', 'timestamp': '1668179459'}, {'tokenPrice': '1687173330484', 'timestamp': '1668178523'}, {'tokenPrice': '1692000000000', 'timestamp': '1668178103'}, {'tokenPrice': '1681935755058', 'timestamp': '1668178091'}, {'tokenPrice': '1671231963748', 'timestamp': '1668178019'}, {'tokenPrice': '1657152000000', 'timestamp': '1668177323'}, {'tokenPrice': '1647008029042', 'timestamp': '1668177119'}, {'tokenPrice': '1655612466764', 'timestamp': '1668176939'}, {'tokenPrice': '1664703000000', 'timestamp': '1668176663'}, {'tokenPrice': '1675299761624', 'timestamp': '1668176495'}, {'tokenPrice': '1683923626271', 'timestamp': '1668176423'}, {'tokenPrice': '1693795000000', 'timestamp': '1668176399'}, {'tokenPrice': '1705114690767', 'timestamp': '1668176183'}, {'tokenPrice': '1713851397327', 'timestamp': '1668175463'}, {'tokenPrice': '1725466000000', 'timestamp': '1668175307'}, {'tokenPrice': '1734745758126', 'timestamp': '1668174959'}, {'tokenPrice': '1734334000000', 'timestamp': '1668174167'}, {'tokenPrice': '1743161835204', 'timestamp': '1668171923'}, {'tokenPrice': '1734070804408', 'timestamp': '1668171347'}, {'tokenPrice': '1729129481561', 'timestamp': '1668167747'}, {'tokenPrice': '1729398968000', 'timestamp': '1668167327'}, {'tokenPrice': '1738870470162', 'timestamp': '1668166607'}, {'tokenPrice': '1729615788627', 'timestamp': '1668164147'}, {'tokenPrice': '1733847297008', 'timestamp': '1668163571'}, {'tokenPrice': '1724962986170', 'timestamp': '1668162011'}, {'tokenPrice': '1733685689894', 'timestamp': '1668160547'}, {'tokenPrice': '1733661500000', 'timestamp': '1668157403'}, {'tokenPrice': '1742747000000', 'timestamp': '1668156947'}, {'tokenPrice': '1737170612686', 'timestamp': '1668153635'}, {'tokenPrice': '1739208795983', 'timestamp': '1668153335'}, {'tokenPrice': '1734963490876', 'timestamp': '1668151031'}



,{'tokenPrice': '1723285784244', 'timestamp': '1668149735'}, {'tokenPrice': '1721681141906', 'timestamp': '1668147515'}, {'tokenPrice': '1730807000000', 'timestamp': '1668146135'}, {'tokenPrice': '1727534077860', 'timestamp': '1668145751'}, {'tokenPrice': '1718127849719', 'timestamp': '1668144695'}, {'tokenPrice': '1708343371826', 'timestamp': '1668143075'}, {'tokenPrice': '1699457607136', 'timestamp': '1668143039'}, {'tokenPrice': '1699167298554', 'timestamp': '1668142595'}, {'tokenPrice': '1701409000000', 'timestamp': '1668138935'}, {'tokenPrice': '1693781000000', 'timestamp': '1668136979'}, {'tokenPrice': '1705741000000', 'timestamp': '1668136175'}, {'tokenPrice': '1715066065951', 'timestamp': '1668135323'}, {'tokenPrice': '1710140000000', 'timestamp': '1668132911'}, {'tokenPrice': '1720883393174', 'timestamp': '1668132599'}, {'tokenPrice': '1730263980852', 'timestamp': '1668132239'}, {'tokenPrice': '1729014923584', 'timestamp': '1668131795'}, {'tokenPrice': '1736377000000', 'timestamp': '1668130535'}, {'tokenPrice': '1751380000000', 'timestamp': '1668130415'}, {'tokenPrice': '1761018000000', 'timestamp': '1668129419'}, {'tokenPrice': '1752141721102', 'timestamp': '1668128123'}, {'tokenPrice': '1744957000000', 'timestamp': '1668126083'}, {'tokenPrice': '1754530300000', 'timestamp': '1668124523'}, {'tokenPrice': '1748764693144', 'timestamp': '1668122603'}, {'tokenPrice': '1758003453115', 'timestamp': '1668122243'}, {'tokenPrice': '1770501000000', 'timestamp': '1668122183'}, {'tokenPrice': '1782227015766', 'timestamp': '1668120947'}, {'tokenPrice': '1776749946111', 'timestamp': '1668117347'}, {'tokenPrice': '1779432329645', 'timestamp': '1668117095'}, {'tokenPrice': '1791363000000', 'timestamp': '1668114623'}, {'tokenPrice': '1802264821869', 'timestamp': '1668114047'}, {'tokenPrice': '1791838300000', 'timestamp': '1668113891'}, {'tokenPrice': '1804741000000', 'timestamp': '1668113831'}, {'tokenPrice': '1794525809596', 'timestamp': '1668113807'}, {'tokenPrice': '1782528890781', 'timestamp': '1668113747'}, {'tokenPrice': '1769939326715', 'timestamp': '1668113723'}, {'tokenPrice': '1759637843037', 'timestamp': '1668113687'}, {'tokenPrice': '1742502759137', 'timestamp': '1668110207'}, {'tokenPrice': '1741525544513', 'timestamp': '1668109991'}, {'tokenPrice': '1731445000000', 'timestamp': '1668107891'}, {'tokenPrice': '1740749000000', 'timestamp': '1668107351'}, {'tokenPrice': '1730997337579', 'timestamp': '1668106511'}, {'tokenPrice': '1729060600653', 'timestamp': '1668104663'}, {'tokenPrice': '1737923123728', 'timestamp': '1668103931'}, {'tokenPrice': '1726139619351', 'timestamp': '1668103391'}, {'tokenPrice': '1716904056092', 'timestamp': '1668102935'}, {'tokenPrice': '1721270000000', 'timestamp': '1668102407'}, {'tokenPrice': '1732694000000', 'timestamp': '1668101987'}, {'tokenPrice': '1751361619225', 'timestamp': '1668101903'}, {'tokenPrice': '1761626041385', 'timestamp': '1668101651'}, {'tokenPrice': '1771945000000', 'timestamp': '1668100031'}, {'tokenPrice': '1780875852722', 'timestamp': '1668099335'}, {'tokenPrice': '1786341651194', 'timestamp': '1668097811'}, {'tokenPrice': '1775375826440', 'timestamp': '1668097151'}, {'tokenPrice': '1765412396178', 'timestamp': '1668097067'}, {'tokenPrice': '1756084000000', 'timestamp': '1668096491'}, {'tokenPrice': '1746434161057', 'timestamp': '1668095735'}, {'tokenPrice': '1740780418141', 'timestamp': '1668094691'}, {'tokenPrice': '1752386354932', 'timestamp': '1668094391'}, {'tokenPrice': '1761716995577', 'timestamp': '1668094295'}, {'tokenPrice': '1771031401735', 'timestamp': '1668093371'}, {'tokenPrice': '1780172214302', 'timestamp': '1668093011'}, {'tokenPrice': '1769900000000', 'timestamp': '1668092627'}, {'tokenPrice': '1760391647309', 'timestamp': '1668092543'}, {'tokenPrice': '1749960926049', 'timestamp': '1668092135'}, {'tokenPrice': '1743541861146', 'timestamp': '1668091175'}, {'tokenPrice': '1752463945410', 'timestamp': '1668090491'}, {'tokenPrice': '1743342000000', 'timestamp': '1668089099'}, {'tokenPrice': '1756271500000', 'timestamp': '1668088799'}, {'tokenPrice': '1746818214997', 'timestamp': '1668088595'}, {'tokenPrice': '1735325000000', 'timestamp': '1668088535'}, {'tokenPrice': '1735116439841', 'timestamp': '1668088511'}, {'tokenPrice': '1724582667191', 'timestamp': '1668087335'}, {'tokenPrice': '1712583243322', 'timestamp': '1668087311'}, {'tokenPrice': '1701700000000', 'timestamp': '1668087179'}, {'tokenPrice': '1677485672530', 'timestamp': '1668087119'}, {'tokenPrice': '1667060158660', 'timestamp': '1668087095'}, {'tokenPrice': '1658680000000', 'timestamp': '1668085559'}, {'tokenPrice': '1649658157477', 'timestamp': '1668084935'}, {'tokenPrice': '1641473434409', 'timestamp': '1668082979'}, {'tokenPrice': '1652278500000', 'timestamp': '1668082619'}, {'tokenPrice': '1642936480495', 'timestamp': '1668082103'}, {'tokenPrice': '1634219048166', 'timestamp': '1668081659'}, {'tokenPrice': '1642807335969', 'timestamp': '1668081335'}, {'tokenPrice': '1640791414929', 'timestamp': '1668080339'}, {'tokenPrice': '1632567877180', 'timestamp': '1668079739'}, {'tokenPrice': '1623406023018', 'timestamp': '1668079139'}, {'tokenPrice': '1634713482495', 'timestamp': '1668077735'}, {'tokenPrice': '1640367000000', 'timestamp': '1668076679'}, {'tokenPrice': '1649545815570', 'timestamp': '1668076403'}, {'tokenPrice': '1659515144928', 'timestamp': '1668075299'}, {'tokenPrice': '1669006742077', 'timestamp': '1668074123'}, {'tokenPrice': '1670353939090', 'timestamp': '1668072779'}, {'tokenPrice': '1679487212624', 'timestamp': '1668071123'}, {'tokenPrice': '1688247000000', 'timestamp': '1668070523'}, {'tokenPrice': '1683508000000', 'timestamp': '1668070463'}, {'tokenPrice': '1674852000000', 'timestamp': '1668070247'}, {'tokenPrice': '1665941000000', 'timestamp': '1668069563'}, {'tokenPrice': '1655000000000', 'timestamp': '1668068663'}, {'tokenPrice': '1664794211974', 'timestamp': '1668068063'}, {'tokenPrice': '1673847500000', 'timestamp': '1668067247'}


,{'tokenPrice': '1671890000000', 'timestamp': '1668066947'}, {'tokenPrice': '1671637976051', 'timestamp': '1668066323'}, {'tokenPrice': '1680460000000', 'timestamp': '1668065687'}, {'tokenPrice': '1671099290427', 'timestamp': '1668063347'}, {'tokenPrice': '1667085110930', 'timestamp': '1668063047'}, {'tokenPrice': '1675813781640', 'timestamp': '1668062363'}, {'tokenPrice': '1666733000000', 'timestamp': '1668059747'}, {'tokenPrice': '1667786000000', 'timestamp': '1668059627'}, {'tokenPrice': '1658987000000', 'timestamp': '1668057503'}, {'tokenPrice': '1668369000000', 'timestamp': '1668057107'}, {'tokenPrice': '1659287330429', 'timestamp': '1668056627'}, {'tokenPrice': '1649276563607', 'timestamp': '1668056543'}, {'tokenPrice': '1639111229091', 'timestamp': '1668056147'}, {'tokenPrice': '1635865128630', 'timestamp': '1668055871'}, {'tokenPrice': '1625833000000', 'timestamp': '1668054767'}, {'tokenPrice': '1634332000000', 'timestamp': '1668052547'}, {'tokenPrice': '1638589939987', 'timestamp': '1668052211'}, {'tokenPrice': '1647908603727', 'timestamp': '1668051947'}, {'tokenPrice': '1638397000000', 'timestamp': '1668050231'}, {'tokenPrice': '1629429000000', 'timestamp': '1668049691'}, {'tokenPrice': '1619478000000', 'timestamp': '1668049355'}, {'tokenPrice': '1611225982700', 'timestamp': '1668048947'}, {'tokenPrice': '1613678000000', 'timestamp': '1668045335'}, {'tokenPrice': '1616123969367', 'timestamp': '1668044831'}, {'tokenPrice': '1624509000000', 'timestamp': '1668044315'}, {'tokenPrice': '1616192497129', 'timestamp': '1668043715'}, {'tokenPrice': '1625487517395', 'timestamp': '1668042155'}, {'tokenPrice': '1615167000000', 'timestamp': '1668041735'}, {'tokenPrice': '1610125900000', 'timestamp': '1668040031'}, {'tokenPrice': '1600108000000', 'timestamp': '1668039539'}, {'tokenPrice': '1610483000000', 'timestamp': '1668039251'}, {'tokenPrice': '1601969412144', 'timestamp': '1668039227'}, {'tokenPrice': '1592850000000', 'timestamp': '1668039095'}]



mydb = mysql.connector.connect(
  host="iot.cpe.ku.ac.th",
  user="b6310546040",
  password="patkamon.a@ku.th",
  database="b6310546040"
)
mycursor = mydb.cursor()

def insert_data(data):
  sql = "INSERT INTO price (price, time) VALUES (%s, %s)"
  mycursor.execute(sql, data)
  mydb.commit()


def sort(list):
    ans = []
    starttime = 1668672000
    endtime = starttime - 7200
    total = 0
    c=0
    for i in range(len(list)):
        if int(list[i]['timestamp']) > endtime and  int(list[i]['timestamp']) <= starttime:
            total += float(list[i]['tokenPrice'])
            c+=1
        else:
            ans.append([int(total/c/10**8),
                        datetime.datetime.fromtimestamp(starttime)
                        ])
            starttime = endtime
            endtime = starttime - 7200
            total = 0
            c= 0 
    return ans

sort_price = sort(price)
for i in range(2,87):
    data = (sort_price[i][0],sort_price[i][1])
    insert_data(data)
