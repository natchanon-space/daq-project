import datetime

import mysql.connector

aave = [{'timestamp': '1668665519', 'totalValueLockedUSD': '583019431.266366528455365024080138', 'totalBorrowBalanceUSD': '58616268.34334998700149672432229175'}, {'timestamp': '1668664511', 'totalValueLockedUSD': '583217742.0378320464910776841744445', 'totalBorrowBalanceUSD': '58616244.53140149270487105047108941'}, {'timestamp': '1668661007', 'totalValueLockedUSD': '583415801.6729424820993069169739385', 'totalBorrowBalanceUSD': '58599633.07570497583373855721507349'}, {'timestamp': '1668657047', 'totalValueLockedUSD': '590467692.1019850708422078007027919', 'totalBorrowBalanceUSD': '59323397.91860079201442880728266955'}, {'timestamp': '1668652295', 'totalValueLockedUSD': '590428077.3204339038207159844165827', 'totalBorrowBalanceUSD': '59239761.40253542129380793584819543'}, {'timestamp': '1668650099', 'totalValueLockedUSD': '590253945.1399690971896454210946352', 'totalBorrowBalanceUSD': '59239709.05908299642246081519719889'}, {'timestamp': '1668645431', 'totalValueLockedUSD': '584064630.8913599471299919025190873', 'totalBorrowBalanceUSD': '58644976.48213467418588562658532844'}, {'timestamp': '1668642731', 'totalValueLockedUSD': '584073165.0999182709477956426071868', 'totalBorrowBalanceUSD': '58644912.72754365330298089057828603'}, {'timestamp': '1668639431', 'totalValueLockedUSD': '584141139.0688226602282419489570335', 'totalBorrowBalanceUSD': '58663803.52303026474500963034679382'}, {'timestamp': '1668635639', 'totalValueLockedUSD': '584486678.1588162003295800019679702', 'totalBorrowBalanceUSD': '58663714.24464175956225884275784049'}, {'timestamp': '1668631067', 'totalValueLockedUSD': '577645991.6239444898071189585282692', 'totalBorrowBalanceUSD': '57363754.68320705120385748591912235'}, {'timestamp': '1668628739', 'totalValueLockedUSD': '577649554.28960668972349323757828', 'totalBorrowBalanceUSD': '57363701.46713198588879078684427421'}, {'timestamp': '1668624779', 'totalValueLockedUSD': '577634635.1743955666663294405724878', 'totalBorrowBalanceUSD': '57313594.85030252305059025455615686'}, {'timestamp': '1668618179', 'totalValueLockedUSD': '582899759.5226043674747999346410752', 'totalBorrowBalanceUSD': '58967595.87917127934291661020651814'}, {'timestamp': '1668617855', 'totalValueLockedUSD': '582916096.9385579513058336324036151', 'totalBorrowBalanceUSD': '58967588.13450851525098600596984155'}, {'timestamp': '1668614063', 'totalValueLockedUSD': '582712889.3675924361647424869406888', 'totalBorrowBalanceUSD': '58935977.55644875593977061076851064'}, {'timestamp': '1668608303', 'totalValueLockedUSD': '582204349.0443827389883261899734353', 'totalBorrowBalanceUSD': '58935839.90315148190895321911336212'}, {'timestamp': '1668607187', 'totalValueLockedUSD': '588335054.6178549800087766346482034', 'totalBorrowBalanceUSD': '59575355.93911080288702520844507291'}, {'timestamp': '1668603107', 'totalValueLockedUSD': '588112207.1316586919459749378321714', 'totalBorrowBalanceUSD': '59717973.52183827454580915695548297'}, {'timestamp': '1668598127', 'totalValueLockedUSD': '593688262.2229778667975378018794178', 'totalBorrowBalanceUSD': '60315677.43919117547384779809879464'}, {'timestamp': '1668594359', 'totalValueLockedUSD': '593638132.680190383396714411661576', 'totalBorrowBalanceUSD': '60315584.93122157452095688501439511'}, {'timestamp': '1668591851', 'totalValueLockedUSD': '593450737.9383221262362922766362977', 'totalBorrowBalanceUSD': '60315523.34146936776974976572716617'}, {'timestamp': '1668588959', 'totalValueLockedUSD': '600221512.9811647415562981430325879', 'totalBorrowBalanceUSD': '61002051.35928039369824608043293628'}, {'timestamp': '1668585443', 'totalValueLockedUSD': '600283386.6354526407020060054464148', 'totalBorrowBalanceUSD': '61001964.03096178008767574578025639'}, {'timestamp': '1668581171', 'totalValueLockedUSD': '600260647.8379936022667334271183503', 'totalBorrowBalanceUSD': '59290006.27895880798440268254892703'}, {'timestamp': '1668577571', 'totalValueLockedUSD': '606197945.3572442017141175308144977', 'totalBorrowBalanceUSD': '59957529.65779502597878921983066205'}, {'timestamp': '1668573059', 'totalValueLockedUSD': '606024580.3145906891516253334072587', 'totalBorrowBalanceUSD': '59910045.54171897341534298351404749'}, {'timestamp': '1668570359', 'totalValueLockedUSD': '605817750.9835646907123962913131872', 'totalBorrowBalanceUSD': '59909981.33883668332098728507989422'}, {'timestamp': '1668567431', 'totalValueLockedUSD': '605373430.4001786816610456358496335', 'totalBorrowBalanceUSD': '59909911.68240928807588706051828251'}, {'timestamp': '1668563663', 'totalValueLockedUSD': '602668203.2853693635477397564691043', 'totalBorrowBalanceUSD': '59528437.24109018784033212702281362'}, {'timestamp': '1668560207', 'totalValueLockedUSD': '602664747.9535371396481071988637444', 'totalBorrowBalanceUSD': '59325898.87754986424466311974400875'}, {'timestamp': '1668555095', 'totalValueLockedUSD': '602574398.108849202277346914469157', 'totalBorrowBalanceUSD': '59325779.01741733674577900570416603'}, {'timestamp': '1668550799', 'totalValueLockedUSD': '602608080.2033823689608013347275671', 'totalBorrowBalanceUSD': '59325678.29574401930766202665308739'}, {'timestamp': '1668548459', 'totalValueLockedUSD': '596677262.1336723368499800678978442', 'totalBorrowBalanceUSD': '58745479.94646852962058240545558107'}, {'timestamp': '1668545519', 'totalValueLockedUSD': '596677297.6228669983082016858418391', 'totalBorrowBalanceUSD': '58745411.68672112173374750928176564'}, {'timestamp': '1668542399', 'totalValueLockedUSD': '589426490.8383655123406837495590198', 'totalBorrowBalanceUSD': '58093577.46878470707514925435370337'}, {'timestamp': '1668538211', 'totalValueLockedUSD': '589406456.9607282707207090153670225', 'totalBorrowBalanceUSD': '58488614.87261182443007200447577447'}, {'timestamp': '1668534707', 'totalValueLockedUSD': '598406122.9386211412041150070319187', 'totalBorrowBalanceUSD': '60220356.69731995329553152559734754'}, {'timestamp': '1668530927', 'totalValueLockedUSD': '598429768.8093718404476683026962072', 'totalBorrowBalanceUSD': '59381454.71414942525303671253819356'}, {'timestamp': '1668527531', 'totalValueLockedUSD': '596362121.8532011593344160138172766', 'totalBorrowBalanceUSD': '59381374.21649032560883459338348396'}, {'timestamp': '1668523979', 'totalValueLockedUSD': '596313935.7943515605109539150241109', 'totalBorrowBalanceUSD': '59381289.95860203889788366829765766'}, {'timestamp': '1668520571', 'totalValueLockedUSD': '602581096.5717357670834725943407915', 'totalBorrowBalanceUSD': '60009643.83949819973932131095578223'}, {'timestamp': '1668516275', 'totalValueLockedUSD': '596433824.6289738344437341375927665', 'totalBorrowBalanceUSD': '59396224.11735670778327060028346549'}, {'timestamp': '1668513083', 'totalValueLockedUSD': '596424289.1028710547235545187584396', 'totalBorrowBalanceUSD': '59396148.37110030119724662569029879'}, {'timestamp': '1668509795', 'totalValueLockedUSD': '596405313.108153873845581815625522', 'totalBorrowBalanceUSD': '59228265.12003542080370979949184404'}, {'timestamp': '1668505583', 'totalValueLockedUSD': '595685598.0278761640895042855288133', 'totalBorrowBalanceUSD': '59228165.67191449171811329649131075'}, {'timestamp': '1668502211', 'totalValueLockedUSD': '595767774.8926854552071344292607804', 'totalBorrowBalanceUSD': '60952561.85783242492001621161355717'}, {'timestamp': '1668499175', 'totalValueLockedUSD': '595380186.442561963555455970510584', 'totalBorrowBalanceUSD': '59273146.68964743690152934214549154'}, {'timestamp': '1668494159', 'totalValueLockedUSD': '587158690.9760804065746323890564175', 'totalBorrowBalanceUSD': '58654531.92008977688065548649471446'}, {'timestamp': '1668488639', 'totalValueLockedUSD': '586987295.3588196351980329431701441', 'totalBorrowBalanceUSD': '58653072.68438718594440531738466014'}, {'timestamp': '1668488351', 'totalValueLockedUSD': '586987288.5992127538827193174036457', 'totalBorrowBalanceUSD': '58601549.59721694161145714229846758'}, {'timestamp': '1668483899', 'totalValueLockedUSD': '586984597.6465100693371592826157793', 'totalBorrowBalanceUSD': '58601445.1041573563893747320697088'}, {'timestamp': '1668479291', 'totalValueLockedUSD': '586885185.8038246448933365930118671', 'totalBorrowBalanceUSD': '60263158.81177687245305116688269636'}, {'timestamp': '1668477203', 'totalValueLockedUSD': '586852275.7646624986036192453217339', 'totalBorrowBalanceUSD': '60263107.066284909204918570817535'}, {'timestamp': '1668473591', 'totalValueLockedUSD': '580634881.1375660848478954739832024', 'totalBorrowBalanceUSD': '59626465.46376356169154109808459422'}, {'timestamp': '1668470243', 'totalValueLockedUSD': '580092797.1939784539929224700245695', 'totalBorrowBalanceUSD': '59626383.29696129855786287376892984'}, {'timestamp': '1668463583', 'totalValueLockedUSD': '573908753.1225995071392211138434479', 'totalBorrowBalanceUSD': '57312461.53600681109391575981215934'}, {'timestamp': '1668462671', 'totalValueLockedUSD': '573876124.3747212909614304195551839', 'totalBorrowBalanceUSD': '57312440.59387992116570040852184852'}, {'timestamp': '1668458915', 'totalValueLockedUSD': '573943826.5406965014305854753790221', 'totalBorrowBalanceUSD': '57312354.35593768682198344423942418'}, {'timestamp': '1668454175', 'totalValueLockedUSD': '581325075.6207788851024154873929042', 'totalBorrowBalanceUSD': '57973320.91538305349866330255486346'}, {'timestamp': '1668451775', 'totalValueLockedUSD': '581198975.4763315332719738201041346', 'totalBorrowBalanceUSD': '57845636.3661858704504796126728692'}, {'timestamp': '1668447647', 'totalValueLockedUSD': '582516341.9315027338694726835826948', 'totalBorrowBalanceUSD': '57595223.9380752933200749502358543'}, {'timestamp': '1668445175', 'totalValueLockedUSD': '582516285.6289729651525064055508645', 'totalBorrowBalanceUSD': '57486477.08273579853222664752308743'}, {'timestamp': '1668441251', 'totalValueLockedUSD': '582467787.3234735384707336158338351', 'totalBorrowBalanceUSD': '57486387.70665890575025087346280142'}, {'timestamp': '1668437615', 'totalValueLockedUSD': '588879891.6400096283920117052321004', 'totalBorrowBalanceUSD': '58099261.54398978059308146978104277'}, {'timestamp': '1668433667', 'totalValueLockedUSD': '602258931.0181548515556953397589235', 'totalBorrowBalanceUSD': '60065157.43304187177012586033156072'}, {'timestamp': '1668429287', 'totalValueLockedUSD': '589293834.0883661584318795220280388', 'totalBorrowBalanceUSD': '58880161.39321761891075225955616032'}, {'timestamp': '1668426239', 'totalValueLockedUSD': '589293762.1569514414131910679594795', 'totalBorrowBalanceUSD': '58880089.46163633190946144977527758'}, {'timestamp': '1668422387', 'totalValueLockedUSD': '589366061.0415405091759797376830329', 'totalBorrowBalanceUSD': '60545796.47948545787200669993864314'}, {'timestamp': '1668418955', 'totalValueLockedUSD': '583715680.4813279313289070449235021', 'totalBorrowBalanceUSD': '60545710.21322460807718799902186931'}, {'timestamp': '1668414095', 'totalValueLockedUSD': '599558793.14363799425101720882889', 'totalBorrowBalanceUSD': '62177651.60033701420358147033909652'}, {'timestamp': '1668412799', 'totalValueLockedUSD': '597570057.9307696897698683262985419', 'totalBorrowBalanceUSD': '61543954.70036654254423602162407165'}, {'timestamp': '1668409031', 'totalValueLockedUSD': '577495094.8028293448570184862400153', 'totalBorrowBalanceUSD': '59203939.47673278108583004817576338'}, {'timestamp': '1668405599', 'totalValueLockedUSD': '565904544.0325708361901058518846763', 'totalBorrowBalanceUSD': '57893002.64327968341078462769330142'}, {'timestamp': '1668401627', 'totalValueLockedUSD': '565989450.3298293489371450423609587', 'totalBorrowBalanceUSD': '58721331.30230105823691617298544406'}, {'timestamp': '1668398267', 'totalValueLockedUSD': '565978367.7196669069281217411123773', 'totalBorrowBalanceUSD': '58721246.16854079873824563100858705'}, {'timestamp': '1668394427', 'totalValueLockedUSD': '565972186.0475377502144600809961158', 'totalBorrowBalanceUSD': '59058017.0223756942222199851259196'}, {'timestamp': '1668391175', 'totalValueLockedUSD': '566165666.9187008544023306433971637', 'totalBorrowBalanceUSD': '59094545.18940093225099814694237507'}, {'timestamp': '1668387359', 'totalValueLockedUSD': '577850949.0259842872428082796429743', 'totalBorrowBalanceUSD': '59884007.01289083223726093478884397'}, {'timestamp': '1668383903', 'totalValueLockedUSD': '584116066.0737916706388257158266961', 'totalBorrowBalanceUSD': '60538021.54016037146113445201926432'}, {'timestamp': '1668379271', 'totalValueLockedUSD': '583858179.9528114528217067205197841', 'totalBorrowBalanceUSD': '60542846.79535199452562016905002488'}, {'timestamp': '1668376691', 'totalValueLockedUSD': '583946971.310436292181661391865744', 'totalBorrowBalanceUSD': '60459999.7688960919072521077273292'}, {'timestamp': '1668372959', 'totalValueLockedUSD': '584197285.1832738513839361360933112', 'totalBorrowBalanceUSD': '60478611.9415795557018818335827174'}, {'timestamp': '1668368759', 'totalValueLockedUSD': '584363269.0197161027734565600869237', 'totalBorrowBalanceUSD': '60478500.97205424387041440579019414'}, {'timestamp': '1668364331', 'totalValueLockedUSD': '584447696.4525057168649762986742584', 'totalBorrowBalanceUSD': '60478384.00828065103119555716905045'}, {'timestamp': '1668360563', 'totalValueLockedUSD': '583837046.0594350023297424334778826', 'totalBorrowBalanceUSD': '60975113.53308413318731394723146125'}, {'timestamp': '1668357995', 'totalValueLockedUSD': '590268025.156651761913104564671471', 'totalBorrowBalanceUSD': '61135631.47537334121280765841236469'}, {'timestamp': '1668354839', 'totalValueLockedUSD': '590119931.991232938194194593438281', 'totalBorrowBalanceUSD': '61018358.86554146696351424696698165'}, {'timestamp': '1668350963', 'totalValueLockedUSD': '590288004.2743007603239723391080688', 'totalBorrowBalanceUSD': '60968033.16436421747976506178049324'}, {'timestamp': '1668347171', 'totalValueLockedUSD': '590249403.3007403379939645926790615', 'totalBorrowBalanceUSD': '60967932.80319936136980126379836705'}, {'timestamp': '1668343355', 'totalValueLockedUSD': '590187139.0101024162584264804414494', 'totalBorrowBalanceUSD': '60883760.14000926512634541432498186'}, {'timestamp': '1668338627', 'totalValueLockedUSD': '584081492.0755268445069576411450991', 'totalBorrowBalanceUSD': '60255877.41141964803187641758107032'}, {'timestamp': '1668331931', 'totalValueLockedUSD': '584048093.2616040173305952307975235', 'totalBorrowBalanceUSD': '60255702.43011297931600563967387974'}, {'timestamp': '1668329855', 'totalValueLockedUSD': '585164297.1470811797462393779696529', 'totalBorrowBalanceUSD': '60367198.02298590536652222478247507'}, {'timestamp': '1668322655', 'totalValueLockedUSD': '585046142.0570678021439362544074403', 'totalBorrowBalanceUSD': '60367009.5029156608163792493512075'}, {'timestamp': '1668315827', 'totalValueLockedUSD': '590999117.865865443464284230156203', 'totalBorrowBalanceUSD': '60980317.16121272346353580050280699'}, {'timestamp': '1668313355', 'totalValueLockedUSD': '590999051.6586651858377280279710275', 'totalBorrowBalanceUSD': '61399441.0973697030421579102789675'}, {'timestamp': '1668309647', 'totalValueLockedUSD': '590980387.3474066301619689323098681', 'totalBorrowBalanceUSD': '61852152.15787638770155772571096122'}, {'timestamp': '1668307055', 'totalValueLockedUSD': '585031289.4603135770703224066861745', 'totalBorrowBalanceUSD': '61228708.80103386955780197083954112'}, {'timestamp': '1668303827', 'totalValueLockedUSD': '585036209.2074228269465566755635109', 'totalBorrowBalanceUSD': '61228622.05964049351736044699385008'}


,{'timestamp': '1668301007', 'totalValueLockedUSD': '585040360.2011898778827128547440657', 'totalBorrowBalanceUSD': '61227301.36875995034842652935907444'}, {'timestamp': '1668297287', 'totalValueLockedUSD': '581044941.3359689019552951697227966', 'totalBorrowBalanceUSD': '61227200.8542331940841466140905363'}, {'timestamp': '1668293519', 'totalValueLockedUSD': '587347401.4653019508163930199673277', 'totalBorrowBalanceUSD': '61896873.51524871874548234363697477'}, {'timestamp': '1668289595', 'totalValueLockedUSD': '587347121.7888193249739345511154248', 'totalBorrowBalanceUSD': '61900639.37781265254025824797263738'}, {'timestamp': '1668286595', 'totalValueLockedUSD': '586628696.8734518217153852339667274', 'totalBorrowBalanceUSD': '61900752.03312971210249484806950672'}, {'timestamp': '1668283115', 'totalValueLockedUSD': '586620327.1090942740234471572423011', 'totalBorrowBalanceUSD': '61900656.60955582748937020250479727'}, {'timestamp': '1668279191', 'totalValueLockedUSD': '586640535.1759907273530854661917339', 'totalBorrowBalanceUSD': '61942701.67879671215056838518566785'}, {'timestamp': '1668275603', 'totalValueLockedUSD': '586644689.3014150394586508928889411', 'totalBorrowBalanceUSD': '61942603.36612153876163658869748854'}, {'timestamp': '1668271979', 'totalValueLockedUSD': '586452406.7915080913624069516228151', 'totalBorrowBalanceUSD': '60499909.37179232887423618342316655'}, {'timestamp': '1668268091', 'totalValueLockedUSD': '586509601.6101734975301556466468547', 'totalBorrowBalanceUSD': '60499287.21472873557673919333943282'}, {'timestamp': '1668264599', 'totalValueLockedUSD': '591230093.1659368723858381196556669', 'totalBorrowBalanceUSD': '60985214.60213026408820612061549883'}, {'timestamp': '1668261503', 'totalValueLockedUSD': '585048121.3567838289370020458007665', 'totalBorrowBalanceUSD': '61097351.01845399378077463073773172'}, {'timestamp': '1668257651', 'totalValueLockedUSD': '585042952.5156739298687504189396058', 'totalBorrowBalanceUSD': '62251919.49545695657955674021018192'}, {'timestamp': '1668253559', 'totalValueLockedUSD': '584242645.8249592581555965847755139', 'totalBorrowBalanceUSD': '62251805.98262944593912432756886127'}, {'timestamp': '1668250799', 'totalValueLockedUSD': '584932312.734558085083224549751014', 'totalBorrowBalanceUSD': '62201530.71578299462827163487376575'}, {'timestamp': '1668246347', 'totalValueLockedUSD': '583985406.4943446538744099334517699', 'totalBorrowBalanceUSD': '61364761.01267390912610161001717832'}, {'timestamp': '1668243563', 'totalValueLockedUSD': '583967677.1868514800862651262294757', 'totalBorrowBalanceUSD': '61364685.73648068003618277613504807'}, {'timestamp': '1668239423', 'totalValueLockedUSD': '590333499.3802789236511084728828902', 'totalBorrowBalanceUSD': '62024260.39958481786001718885457398'}, {'timestamp': '1668236375', 'totalValueLockedUSD': '583815961.0288327057801369120832289', 'totalBorrowBalanceUSD': '61375724.62429919191988328598646277'}, {'timestamp': '1668232727', 'totalValueLockedUSD': '584278708.2560733317479456601403861', 'totalBorrowBalanceUSD': '61409107.73930291911078904026071697'}, {'timestamp': '1668229079', 'totalValueLockedUSD': '590677481.1992050003764454141008482', 'totalBorrowBalanceUSD': '60755519.56443754395720736144447087'}, {'timestamp': '1668225191', 'totalValueLockedUSD': '590738943.4113843835044810317197491', 'totalBorrowBalanceUSD': '60715335.10741831290715889484192932'}, {'timestamp': '1668221051', 'totalValueLockedUSD': '596490778.0258937897515965603671234', 'totalBorrowBalanceUSD': '62868719.30709723227899204136669439'}, {'timestamp': '1668217955', 'totalValueLockedUSD': '596492186.1349101675520325633112721', 'totalBorrowBalanceUSD': '61963187.16763248335069904870745072'}, {'timestamp': '1668214679', 'totalValueLockedUSD': '596429029.956712927943683785555388', 'totalBorrowBalanceUSD': '61985314.90273870901323065283122128'}, {'timestamp': '1668211175', 'totalValueLockedUSD': '595586274.4649843422408402069373795', 'totalBorrowBalanceUSD': '62054046.40439506153758350658602771'}, {'timestamp': '1668207467', 'totalValueLockedUSD': '580786218.8013820624529265634198419', 'totalBorrowBalanceUSD': '59973535.46371029645450353152764032'}, {'timestamp': '1668203507', 'totalValueLockedUSD': '580994761.4620953810751749763842475', 'totalBorrowBalanceUSD': '59910485.39563819471998653926228342'}, {'timestamp': '1668200171', 'totalValueLockedUSD': '575186235.140966833601198279230168', 'totalBorrowBalanceUSD': '59308473.36388648415139177112131823'}, {'timestamp': '1668196751', 'totalValueLockedUSD': '577076773.0751079261400627468132352', 'totalBorrowBalanceUSD': '59423053.1477424831471461982899913'}, {'timestamp': '1668192419', 'totalValueLockedUSD': '582391863.9082524932569730480272578', 'totalBorrowBalanceUSD': '60178358.05462314738859036826762529'}, {'timestamp': '1668189527', 'totalValueLockedUSD': '579162982.4045941185025684308482378', 'totalBorrowBalanceUSD': '58142772.82614456601248468448253029'}, {'timestamp': '1668185879', 'totalValueLockedUSD': '568453614.7657563952307500290676712', 'totalBorrowBalanceUSD': '56199518.696315072544215302226698'}, {'timestamp': '1668182087', 'totalValueLockedUSD': '580158544.8476167973429446464619323', 'totalBorrowBalanceUSD': '59011618.77201912462322312793980751'}, {'timestamp': '1668178739', 'totalValueLockedUSD': '573405317.2393756735272179338271565', 'totalBorrowBalanceUSD': '58365045.12458483715145084310388433'}, {'timestamp': '1668174671', 'totalValueLockedUSD': '603675930.4434016657134459191550266', 'totalBorrowBalanceUSD': '61449017.43665326401358170580441529'}, {'timestamp': '1668168503', 'totalValueLockedUSD': '596626488.5873843718001147977776029', 'totalBorrowBalanceUSD': '60652670.91432551540815252061615036'}, {'timestamp': '1668163283', 'totalValueLockedUSD': '596520297.7703485235197521195097394', 'totalBorrowBalanceUSD': '60652532.34877018539224386880141509'}, {'timestamp': '1668160067', 'totalValueLockedUSD': '596482844.3608380902444711249265612', 'totalBorrowBalanceUSD': '60687333.68849508634683040526947818'}, {'timestamp': '1668156923', 'totalValueLockedUSD': '596484710.0705389384540801695428615', 'totalBorrowBalanceUSD': '60677133.03987846757740733894587182'}, {'timestamp': '1668153467', 'totalValueLockedUSD': '589963467.5439722598651117104090325', 'totalBorrowBalanceUSD': '57326021.19582740290142975425909677'}, {'timestamp': '1668149879', 'totalValueLockedUSD': '583966820.1494362694209805652457357', 'totalBorrowBalanceUSD': '56694851.55742869394315793003089428'}, {'timestamp': '1668146279', 'totalValueLockedUSD': '590441564.5608766662719057386499518', 'totalBorrowBalanceUSD': '57264617.28859604804943494012718212'}, {'timestamp': '1668142583', 'totalValueLockedUSD': '578396493.5905466232889869820355354', 'totalBorrowBalanceUSD': '56073145.58263230010644909419563185'}, {'timestamp': '1668136595', 'totalValueLockedUSD': '577963480.4598260091758335575337201', 'totalBorrowBalanceUSD': '56059833.1366519963242079311087398'}, {'timestamp': '1668135059', 'totalValueLockedUSD': '583981790.2052020489665391480747106', 'totalBorrowBalanceUSD': '56669596.66925066468542644679396961'}, {'timestamp': '1668130835', 'totalValueLockedUSD': '596821523.322855219662983551395339', 'totalBorrowBalanceUSD': '57903374.58623397281046949781726585'}, {'timestamp': '1668127751', 'totalValueLockedUSD': '603813140.6605824592949621497185082', 'totalBorrowBalanceUSD': '58543735.79882045499602819824402702'}, {'timestamp': '1668123827', 'totalValueLockedUSD': '611157756.1229771278028392739608486', 'totalBorrowBalanceUSD': '59133033.63015321135890716358660262'}, {'timestamp': '1668121199', 'totalValueLockedUSD': '619485699.1932118529524049168329166', 'totalBorrowBalanceUSD': '59920602.44499431942229274538348932'}, {'timestamp': '1668117551', 'totalValueLockedUSD': '619323876.6891325369322197662567999', 'totalBorrowBalanceUSD': '59897984.14282262219316241578759282'}, {'timestamp': '1668112487', 'totalValueLockedUSD': '602314191.6301415918281068488569189', 'totalBorrowBalanceUSD': '58203800.72494589101716295976410777'}, {'timestamp': '1668109499', 'totalValueLockedUSD': '597103849.2035111020766559912230081', 'totalBorrowBalanceUSD': '57611973.69782707084855114793055064'}, {'timestamp': '1668106799', 'totalValueLockedUSD': '594915236.2284550839776953938751641', 'totalBorrowBalanceUSD': '57404588.39532453705009327456996226'}, {'timestamp': '1668103031', 'totalValueLockedUSD': '587588933.7694100240412961625091711', 'totalBorrowBalanceUSD': '56773063.52694249296330688473708292'}, {'timestamp': '1668099287', 'totalValueLockedUSD': '612673650.4439831445001554197406238', 'totalBorrowBalanceUSD': '59370033.09841587628070469397207059'}, {'timestamp': '1668095687', 'totalValueLockedUSD': '600076493.463896538320135205814464', 'totalBorrowBalanceUSD': '58428218.88299529194669105508465029'}, {'timestamp': '1668091991', 'totalValueLockedUSD': '599945043.9372349241297594840022691', 'totalBorrowBalanceUSD': '58495279.89908045451140087854643527'}, {'timestamp': '1668088703', 'totalValueLockedUSD': '600242388.7049373881567900605035709', 'totalBorrowBalanceUSD': '58495197.55170306662342028393250418'}, {'timestamp': '1668085199', 'totalValueLockedUSD': '567921041.7045803982781479640010144', 'totalBorrowBalanceUSD': '55153062.09932512789931290858669024'}, {'timestamp': '1668081359', 'totalValueLockedUSD': '561990347.682723152339148987233464', 'totalBorrowBalanceUSD': '54580722.94935219517277797488129197'}, {'timestamp': '1668076955', 'totalValueLockedUSD': '568191178.2918805571877160136517782', 'totalBorrowBalanceUSD': '55012737.16545395895254237629233595'}, {'timestamp': '1668074363', 'totalValueLockedUSD': '574298874.9611775415061137042712389', 'totalBorrowBalanceUSD': '55437836.18151710732902663084578985'}, {'timestamp': '1668069623', 'totalValueLockedUSD': '572760729.2624045743616180058767869', 'totalBorrowBalanceUSD': '55083382.8532336937046070790681831'}, {'timestamp': '1668066467', 'totalValueLockedUSD': '572851710.5237755629599420041829991', 'totalBorrowBalanceUSD': '55083309.24644398246241270930698415'}, {'timestamp': '1668062711', 'totalValueLockedUSD': '583104388.8036933200740816493904219', 'totalBorrowBalanceUSD': '54493856.15301814963789240797276056'}, {'timestamp': '1668059831', 'totalValueLockedUSD': '588777631.9953459785212591273895295', 'totalBorrowBalanceUSD': '55074344.0741446533635129910726419'}, {'timestamp': '1668056027', 'totalValueLockedUSD': '582110069.1257084688588542340670369', 'totalBorrowBalanceUSD': '53187723.74353542257685256924782859'}, {'timestamp': '1668052643', 'totalValueLockedUSD': '582006923.7990101344767134664230278', 'totalBorrowBalanceUSD': '54825003.13221468406090447742926889'}, {'timestamp': '1668049103', 'totalValueLockedUSD': '574536013.0059285921605142301225699', 'totalBorrowBalanceUSD': '52511974.36419664254854379999568946'}, {'timestamp': '1668045539', 'totalValueLockedUSD': '574487764.4354462588302567389691974', 'totalBorrowBalanceUSD': '52511645.02720537622085615645454415'}, {'timestamp': '1668041951', 'totalValueLockedUSD': '573572904.2807906537995833335934041', 'totalBorrowBalanceUSD': '52486398.36998099005286576510921462'}]

mydb = mysql.connector.connect(
  host="iot.cpe.ku.ac.th",
  user="b6310546040",
  password="patkamon.a@ku.th",
  database="b6310546040"
)
mycursor = mydb.cursor()

def insert_data(data):
  sql = "INSERT INTO aave (lend, borrow, time) VALUES (%s, %s, %s)"
  mycursor.execute(sql, data)
  mydb.commit()


def sort(list):
    ans = []
    starttime = 1668672000
    endtime = starttime - 7200
    totalL = 0
    totalB = 0
    for i in range(len(list)):
        if int(list[i]['timestamp']) > endtime and  int(list[i]['timestamp']) <= starttime:
            totalL += float(list[i]['totalValueLockedUSD'])
            totalB += float(list[i]['totalBorrowBalanceUSD'])
        else:
            ans.append([totalL,totalB, 
                        datetime.datetime.fromtimestamp(starttime)
                        ])
            starttime = endtime
            endtime = starttime - 7200
            totalL = 0
            totalB = 0
    return ans

sort_aave = sort(aave)

for i in range(2,87):
    data = (sort_aave[i][0],sort_aave[i][1], sort_aave[i][2])
    insert_data(data)
